<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLACK DICE CASINO</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="logo">Black Dice CASINO</div>
        <nav>
            <ul id="nav-menu">
                <li><a href="#" id="home-btn">Início</a></li>
                <li><a href="#" id="games-btn">Jogos</a></li>
                <li><a href="#" id="promotions-btn">Promoções</a></li>
                <li><a href="#" id="live-casino-btn">Cassino Ao Vivo</a></li>
                <li><a href="#" id="slots-btn">Slots</a></li>
                <li><a href="#" id="sports-btn">Esportes</a></li>
                <li><a href="#" id="contact-btn">Contato</a></li>
                <li><a href="#" class="btn login" id="login-btn">Entrar</a></li>
                <li><a href="#" class="btn signup" id="signup-btn">Cadastrar</a></li>
            </ul>
            <ul id="user-info" style="display: none;">
                <li><span id="user-name"></span>, <span id="user-balance"></span></li>
                <li><a href="#" class="btn deposit">Depositar</a></li>
                <li><a href="#" class="btn logout" id="logout-btn">Logout</a></li>
            </ul>
        </nav>
    </header>
    <div class="container">
        <aside class="sidebar">
            <ul>
                <li><a href="#" id="live-casino-sidebar">Cassino Ao Vivo</a></li>
                <li><a href="#" id="slots-sidebar">Slots</a></li>
                <li><a href="#" id="sports-sidebar">Esportes</a></li>
                <li><a href="#">Black Dice</a></li>
                <li><a href="#">Bônus</a></li>
                <li><a href="#">Suporte</a></li>
            </ul>
        </aside>
        <main id="main-content">
            <section class="banner" id="banner-section">
                <div class="banner-slider" id="banner-slider">
                    <div class="slide">
                        <img src="banner2.png" alt="Banner 1">
                        <div class="banner-text">
                            <h1>Promoção Imperdível!</h1>
                            <p>Ganhe até 500% de bônus!</p>
                        </div>
                    </div>
                    <div class="slide">
                        <img src="banner2.png" alt="Banner 2">
                        <div class="banner-text">
                            <h1>Giros Grátis</h1>
                            <p>Até 100 giros grátis em slots!</p>
                        </div>
                    </div>
                </div>
            </section>
            <section class="iframe-container" id="iframe-container" style="display: none;">
                <iframe id="game-iframe" width="100%" height="600px" src="" frameborder="0"></iframe>
            </section>
            <section class="games" id="popular-games">
                <h2>Jogos Populares</h2>
                <div class="games-grid"></div>
            </section>
            <section class="live-casino" id="live-casino-games" style="display: none;">
                <h2>Cassino Ao Vivo</h2>
                <div class="games-grid"></div>
            </section>
            <section class="slots" id="slots-games" style="display: none;">
                <h2>Slots</h2>
                <div class="games-grid"></div>
            </section>
            <section class="sports" id="sports-games" style="display: none;">
                <h2>Esportes</h2>
                <div class="games-grid"></div>
            </section>
        </main>
        <main id="form-content" style="display: none;">
            <div class="form-container">
                <form id="login-form">
                    <h2>Entrar</h2>
                    <div class="form-group">
                        <label for="loginEmail">Email:</label>
                        <input type="email" id="loginEmail" name="loginEmail" required maxlength="50">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Senha:</label>
                        <input type="password" id="loginPassword" name="loginPassword" required maxlength="20">
                    </div>
                    <div class="form-buttons">
                        <button type="submit" class="btn login" id="loginButton">Entrar</button>
                        <button type="button" class="btn signup" id="show-signup-form">Cadastrar</button>
                    </div>
                </form>
                <form id="signup-form" method="POST" action="signup.php" style="display: none;">
                    <h2>Cadastrar</h2>
                    <div class="form-group">
                        <label for="signupName">Nome:</label>
                        <input type="text" id="signupName" name="signupName" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPix">PIX:</label>
                        <input type="text" id="signupPix" name="signupPix" required>
                    </div>
                    <div class="form-group">
                        <label for="signupCPF">CPF:</label>
                        <input type="text" id="signupCPF" name="signupCPF" required>
                    </div>
                    <div class="form-group">
                        <label for="signupDOB">Data de Nascimento:</label>
                        <input type="date" id="signupDOB" name="signupDOB" required>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email:</label>
                        <input type="email" id="signupEmail" name="signupEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPhone">Telefone:</label>
                        <input type="tel" id="signupPhone" name="signupPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Senha:</label>
                        <input type="password" id="signupPassword" name="signupPassword" required maxlength="20">
                    </div>
                    <div class="form-buttons">
                        <button type="submit" class="btn signup" id="signupButton">Cadastrar</button>
                        <button type="button" class="btn login" id="show-login-form">Entrar</button>
                    </div>
                </form>
            </div>
        </main>
    </div>
    <div id="alert" class="alert" style="display: none;">
        <div class="alert-content">
            <p>회원가입이 완료되었습니다!</p>
            <button id="close-alert" class="btn">확인</button>
        </div>
    </div>
    <footer>
        <p>&copy; 2024 Black Dice CASINO. Todos os direitos reservados.</p>
        <p>A Prolific Trade N.V. é licenciada e regulamentada pela Antillephone N.V, sob a licença nº 8048/JAZ2024-009</p>
        <p>A Black Dice aceita apenas clientes com mais de 18 anos de idade. Apostar pode ser viciante. Jogue responsavelmente.</p>
    </footer>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-analytics.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDhRkSDgED4xcWTAHvA_bRMhACNIUA1SLQ",
            authDomain: "blackdice-490e9.firebaseapp.com",
            projectId: "blackdice-490e9",
            storageBucket: "blackdice-490e9.appspot.com",
            messagingSenderId: "468114117476",
            appId: "1:468114117476:web:626cbb82e7b8a5d72b2071",
            measurementId: "G-5NEKZ1MRRP"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth();
        const db = getFirestore(app);

        const mainContent = document.getElementById("main-content");
        const formContent = document.getElementById("form-content");
        const loginForm = document.getElementById("login-form");
        const signupForm = document.getElementById("signup-form");
        const iframeContainer = document.getElementById("iframe-container");
        const gameIframe = document.getElementById("game-iframe");
        const bannerSection = document.getElementById("banner-section");

        const homeBtn = document.getElementById("home-btn");
        const loginBtn = document.getElementById("login-btn");
        const signupBtn = document.getElementById("signup-btn");
        const showSignupFormBtn = document.getElementById("show-signup-form");
        const showLoginFormBtn = document.getElementById("show-login-form");

        const liveCasinoSidebar = document.getElementById("live-casino-sidebar");
        const slotsSidebar = document.getElementById("slots-sidebar");
        const sportsSidebar = document.getElementById("sports-sidebar");

        const navMenu = document.getElementById("nav-menu");
        const userInfo = document.getElementById("user-info");
        const userName = document.getElementById("user-name");
        const userBalance = document.getElementById("user-balance");

        const alertBox = document.getElementById("alert");
        const closeAlertBtn = document.getElementById("close-alert");

        closeAlertBtn.addEventListener("click", () => {
            alertBox.style.display = "none";
        });

        homeBtn.addEventListener("click", function() {
            mainContent.style.display = "block";
            formContent.style.display = "none";
            iframeContainer.style.display = "none";
            bannerSection.style.display = "block";
            document.getElementById("popular-games").style.display = "block";
            document.getElementById("live-casino-games").style.display = "none";
            document.getElementById("slots-games").style.display = "none";
            document.getElementById("sports-games").style.display = "none";
            generateGames('popular-games', 12);
        });

        loginBtn.addEventListener("click", function() {
            mainContent.style.display = "none";
            formContent.style.display = "flex";
            iframeContainer.style.display = "none";
            bannerSection.style.display = "none";
            loginForm.style.display = "block";
            signupForm.style.display = "none";
        });

        signupBtn.addEventListener("click", function() {
            mainContent.style.display = "none";
            formContent.style.display = "flex";
            iframeContainer.style.display = "none";
            bannerSection.style.display = "none";
            loginForm.style.display = "none";
            signupForm.style.display = "block";
        });

        showSignupFormBtn.addEventListener("click", function() {
            loginForm.style.display = "none";
            signupForm.style.display = "block";
        });

        showLoginFormBtn.addEventListener("click", function() {
            signupForm.style.display = "none";
            loginForm.style.display = "block";
        });

        document.getElementById('signupButton').addEventListener('click', (event) => {
            event.preventDefault();
            const signupEmail = document.getElementById('signupEmail').value;
            const signupPassword = document.getElementById('signupPassword').value;
            const signupName = document.getElementById('signupName').value;
            const signupPix = document.getElementById('signupPix').value;
            const signupCPF = document.getElementById('signupCPF').value;
            const signupDOB = document.getElementById('signupDOB').value;
            const signupPhone = document.getElementById('signupPhone').value;

            createUserWithEmailAndPassword(auth, signupEmail, signupPassword)
                .then((userCredential) => {
                    const user = userCredential.user;
                    // Save additional user information in the Firestore
                    const userRef = doc(db, "users", user.uid);
                    setDoc(userRef, {
                        name: signupName,
                        pix: signupPix,
                        cpf: signupCPF,
                        dob: signupDOB,
                        phone: signupPhone,
                        balance: 0 // Initialize balance
                    }).then(() => {
                        // Show alert and redirect to login form
                        alertBox.style.display = "block";
                        signupForm.style.display = "none";
                        loginForm.style.display = "block";
                    });
                })
                .catch((error) => {
                    console.error(error.code, error.message);
                });
        });

        document.getElementById('loginButton').addEventListener('click', (event) => {
            event.preventDefault();
            const loginEmail = document.getElementById('loginEmail').value;
            const loginPassword = document.getElementById('loginPassword').value;

            signInWithEmailAndPassword(auth, loginEmail, loginPassword)
                .then((userCredential) => {
                    const user = userCredential.user;
                    updateUserInfo(user);
                    // Redirect to home screen after login
                    homeBtn.click();
                })
                .catch((error) => {
                    console.error(error.code, error.message);
                });
        });

        document.getElementById('logout-btn').addEventListener('click', () => {
            signOut(auth).then(() => {
                navMenu.style.display = "flex";
                userInfo.style.display = "none";
            }).catch((error) => {
                console.error(error.code, error.message);
            });
        });

        onAuthStateChanged(auth, (user) => {
            if (user) {
                updateUserInfo(user);
            } else {
                navMenu.style.display = "flex";
                userInfo.style.display = "none";
            }
        });

        function updateUserInfo(user) {
            const userRef = doc(db, "users", user.uid);
            getDoc(userRef).then((docSnap) => {
                if (docSnap.exists()) {
                    const userData = docSnap.data();
                    userName.innerText = `${userData.name} 회원님`;
                    userBalance.innerText = `잔액: ${userData.balance} BRL`;
                    navMenu.style.display = "none";
                    userInfo.style.display = "flex";
                } else {
                    console.error("No such document!");
                }
            }).catch((error) => {
                console.error(error.code, error.message);
            });
        }

        function showLiveCasino() {
            mainContent.style.display = "block";
            formContent.style.display = "none";
            iframeContainer.style.display = "none";
            bannerSection.style.display = "none";
            document.getElementById("popular-games").style.display = "none";
            document.getElementById("live-casino-games").style.display = "block";
            document.getElementById("slots-games").style.display = "none";
            document.getElementById("sports-games").style.display = "none";
        }

        function generateGames(sectionId, count) {
            var section = document.getElementById(sectionId);
            var gamesGrid = section.querySelector('.games-grid');
            gamesGrid.innerHTML = '';

            var gameNames = [
                "Blackjack Classic", "Roleta Europeia", "Baccarat", "Poker Texas Hold'em", "Bingo", "Caça-níquel Megaways",
                "Craps", "Pôquer de Três Cartas", "Baccarat Ao Vivo", "Roleta Americana", "Blackjack VIP", "Dream Catcher",
                "Monopoly Live", "Mega Ball", "Sic Bo", "Dragon Tiger", "Jogo do Bicho", "Keno", "Roleta Francesa", "Blackjack Switch",
                "Stud Poker", "Casino Hold'em", "Double Ball Roulette", "Football Studio", "Lightning Dice", "Deal or No Deal",
                "Side Bet City", "Crazy Time", "Mega Wheel", "Cash or Crash", "Gonzo's Treasure Hunt", "Roulette Double Up",
                "Poker Omaha", "Baccarat Squeeze", "Pontoon", "Three Card Poker Prime", "Dragonara Roulette", "Auto Roulette",
                "Speed Baccarat", "No Commission Baccarat", "First Person Blackjack", "Caribbean Stud Poker", "Texas Hold'em Bonus",
                "Free Bet Blackjack", "Infinite Blackjack", "Blackjack Party", "Instant Roulette", "Double Exposure Blackjack",
                "European Poker Tour", "World Series of Poker", "PokerStars Live", "All American Poker", "Ultimate Texas Hold'em",
                "Let It Ride", "Pai Gow Poker", "Five Card Draw", "High Card Flush", "Razz Poker", "Chinese Poker", "Open Face Chinese Poker"
            ];

            for (var i = 0; i < count; i++) {
                var gameItem = document.createElement('div');
                gameItem.className = 'game-item';
                gameItem.innerHTML = `
                    <img src="image${i % 60 + 1}.png" alt="${gameNames[i % gameNames.length]}">
                    <h3>${gameNames[i % gameNames.length]}</h3>
                    <div class="game-buttons">
                        <a href="javascript:void(0)" class="btn small play-now" data-video="https://client.pragmaticplaylive.net/desktop/baccaratgame/?tabletype=baccaratgame&casino_id=ppcdk00000003125&web_server=https://gs7.pragmaticplaylive.net&config_url=/cgibin/appconfig/xml/configs/urls.xml&JSESSIONID=Mgyr8QVJd-iD_qePKF-BoWd-MejUOQ6GjiT6RkkHbgK3x8hPU4VV!-1126357492-02f58491&table_id=bc281koreanch281&socket_server=wss://gs7.pragmaticplaylive.net/game&token=Mgyr8QVJd-iD_qePKF-BoWd-MejUOQ6GjiT6RkkHbgK3x8hPU4VV!-1126357492-02f58491&stats_collector_uuid=1ae7e98e-9086-4591-94cc-26d5f29f2f5e&actual_web_server=https://gs7.pragmaticplaylive.net&socket_port=443&uiAddress=https://client.pragmaticplaylive.net/desktop/baccaratgame/&uiversion=1.15.2&gametype=baccarat&operator_theme=default/speed_baccarat_korean&game_mode=html5_desktop&lobby_version=2&lang=ko&swf_lobby_path=/member/games/lobby.swf&meta_server=https://games.pragmaticplaylive.net&lobbyGameSymbol=null&">Jogar Agora</a>
                        <a href="#" class="btn small">Demo</a>
                    </div>
                `;
                gamesGrid.appendChild(gameItem);
            }

            var playNowButtons = document.querySelectorAll(".play-now");
            playNowButtons.forEach(function(button) {
                button.addEventListener("click", function() {
                    var videoSrc = this.getAttribute("data-video");
                    bannerSection.style.display = "none";
                    iframeContainer.style.display = "block";
                    gameIframe.src = videoSrc;

                    gameIframe.onload = function() {
                        setTimeout(function() {
                            var iframeDoc = gameIframe.contentDocument || gameIframe.contentWindow.document;
                            var betBoardWrapper = iframeDoc.querySelector(".betboard_desktop_wrapper.dndBetBoard.droppable-cancel.global_bb_shadow");
                            var userBalanceElement = document.getElementById("user-balance");

                            function decreaseBalance() {
                                var balance = parseFloat(userBalanceElement.innerText.replace('잔액: ', '').replace(' BRL', '').replace(/\./g, '').replace(',', '.'));
                                balance -= 1;
                                userBalanceElement.innerText = '잔액: ' + balance.toLocaleString('pt-BR') + ' BRL';
                            }

                            function attachClickListeners() {
                                var paths = betBoardWrapper.querySelectorAll("path");
                                paths.forEach(function(path) {
                                    path.addEventListener("click", decreaseBalance);
                                });
                            }

                            if (betBoardWrapper) {
                                attachClickListeners();
                            } else {
                                var interval = setInterval(function() {
                                    betBoardWrapper = iframeDoc.querySelector(".betboard_desktop_wrapper.dndBetBoard.droppable-cancel.global_bb_shadow");
                                    if (betBoardWrapper) {
                                        attachClickListeners();
                                        clearInterval(interval);
                                    }
                                }, 1000);
                            }
                        }, 3000);
                    };
                });
            });
        }

        generateGames('popular-games', 12);
        generateGames('live-casino-games', 60);
        generateGames('slots-games', 60);
        generateGames('sports-games', 60);

        liveCasinoSidebar.addEventListener("click", function() {
            showLiveCasino();
        });

        slotsSidebar.addEventListener("click", function() {
            mainContent.style.display = "block";
            formContent.style.display = "none";
            iframeContainer.style.display = "none";
            bannerSection.style.display = "none";
            document.getElementById("popular-games").style.display = "none";
            document.getElementById("live-casino-games").style.display = "none";
            document.getElementById("slots-games").style.display = "block";
            document.getElementById("sports-games").style.display = "none";
        });

        sportsSidebar.addEventListener("click", function() {
            mainContent.style.display = "block";
            formContent.style.display = "none";
            iframeContainer.style.display = "none";
            bannerSection.style.display = "none";
            document.getElementById("popular-games").style.display = "none";
            document.getElementById("live-casino-games").style.display = "none";
            document.getElementById("slots-games").style.display = "none";
            document.getElementById("sports-games").style.display = "block";
        });
    </script>
</body>
</html>
